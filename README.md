kelaopendata
================
2024-04-11

Install

``` r
remotes::install_github("rOpenGov/kelaopendata")
```

List datasets

``` r
library(kelaopendata)
```

    ## Warning: replacing previous import 'ckanr::changes' by 'dplyr::changes' when
    ## loading 'kelaopendata'

``` r
dsets <- list_datasets()
dsets
```

    ## # A tibble: 20 × 3
    ##    name                                                           id    modified
    ##    <chr>                                                          <chr> <chr>   
    ##  1 kuntien-rahoittama-tyomarkkinatuki                             970f… 2024-04…
    ##  2 kelan-maksamat-elake-etuudet                                   341d… 2024-04…
    ##  3 maksetut-yleiset-asumistuet1                                   f80f… 2024-03…
    ##  4 maksetut-takuuelakkeet                                         17cd… 2024-03…
    ##  5 suomen-tyokyvyttomyyselakkeensaajat-sairauden-mukaan           8be0… 2024-04…
    ##  6 perustoimeentulotuen-saajat                                    af7a… 2024-04…
    ##  7 etuuksien-ratkaisut                                            3fec… 2024-03…
    ##  8 kelan-elake-etuuden-saajat-ja-keskimaaraiset-etuudet           8df7… 2024-04…
    ##  9 kelan-maksaman-perustoimeentulotuen-menot-ja-palautukset       4b64… 2024-03…
    ## 10 vanhempainpaivarahojen-saajat-ja-maksetut-etuudet              fcec… 2024-04…
    ## 11 tyomarkkinatuen-saajat-tukipaivien-kertyman-ja-korvausperuste… 06fc… 2024-04…
    ## 12 kelan-tyottomyysetuudet-korvausperusteen-mukaan                3080… 2024-04…
    ## 13 perustoimeentulotuen-saajakotitaloudet                         802e… 2024-03…
    ## 14 kelan-tyottomyysetuuksien-saajat-kuukauden-lopussa             4378… 2024-04…
    ## 15 kunnan-osarahoittaman-tyomarkkinatuen-saajat-ja-maksetut-etuu… 5dd6… 2024-04…
    ## 16 koulumatkatuen-saajat-ja-maksetut-tuet                         3937… 2024-04…
    ## 17 helsingin-seudun-sairastavuusindeksi                           06f6… 2023-06…
    ## 18 opintotuen-saajat-ja-maksetut-tuet                             6c4d… 2024-04…
    ## 19 kelan-etuuksien-saajat-ja-maksetut-etuudet                     9af3… 2024-03…
    ## 20 sairaanhoitokorvausten-saajat-ja-maksetut-korvaukset           2236… 2024-04…

Get first 10 rows of data

``` r
get_head(data_id = dsets$id[1])
```

    ## 
    ## Attaching package: 'dplyr'

    ## The following objects are masked from 'package:stats':
    ## 
    ##     filter, lag

    ## The following object is masked from '.env':
    ## 
    ##     n

    ## The following objects are masked from 'package:base':
    ## 
    ##     intersect, setdiff, setequal, union

    ## # A tibble: 10 × 13
    ##    aikatyyppi kuukausi_nro vuosikuukausi vuosi kunta_nro kunta_nimi ikaryhma    
    ##    <chr>             <dbl>         <dbl> <dbl> <chr>     <chr>      <chr>       
    ##  1 Kuukausi              1        202201  2022 992       Äänekoski  Tieto puutt…
    ##  2 Kuukausi              1        202201  2022 980       Ylöjärvi   Tieto puutt…
    ##  3 Kuukausi              1        202201  2022 977       Ylivieska  Tieto puutt…
    ##  4 Kuukausi              1        202201  2022 946       Vöyri      Tieto puutt…
    ##  5 Kuukausi              1        202201  2022 934       Vimpeli    Tieto puutt…
    ##  6 Kuukausi              1        202201  2022 927       Vihti      Tieto puutt…
    ##  7 Kuukausi              1        202201  2022 925       Vieremä    Tieto puutt…
    ##  8 Kuukausi              1        202201  2022 924       Veteli     Tieto puutt…
    ##  9 Kuukausi              1        202201  2022 922       Vesilahti  Tieto puutt…
    ## 10 Kuukausi              1        202201  2022 921       Vesanto    Tieto puutt…
    ## # ℹ 6 more variables: sukupuoli <chr>, tyomarkkinatukipaiva_luokka <chr>,
    ## #   saaja_lkm <dbl>, korvattu_paiva_lkm <dbl>, maksettu_eur <dbl>,
    ## #   kunta_osuus_eur <dbl>

Whole dataset

``` r
whole_data <- get_data(data_id = dsets$id[1], sql = NA)
whole_data
```

    ## # A tibble: 2,070,511 × 13
    ##    aikatyyppi kuukausi_nro vuosikuukausi vuosi kunta_nro kunta_nimi ikaryhma    
    ##    <chr>             <dbl>         <dbl> <dbl> <chr>     <chr>      <chr>       
    ##  1 Kuukausi              1        202201  2022 992       Äänekoski  Tieto puutt…
    ##  2 Kuukausi              1        202201  2022 980       Ylöjärvi   Tieto puutt…
    ##  3 Kuukausi              1        202201  2022 977       Ylivieska  Tieto puutt…
    ##  4 Kuukausi              1        202201  2022 946       Vöyri      Tieto puutt…
    ##  5 Kuukausi              1        202201  2022 934       Vimpeli    Tieto puutt…
    ##  6 Kuukausi              1        202201  2022 927       Vihti      Tieto puutt…
    ##  7 Kuukausi              1        202201  2022 925       Vieremä    Tieto puutt…
    ##  8 Kuukausi              1        202201  2022 924       Veteli     Tieto puutt…
    ##  9 Kuukausi              1        202201  2022 922       Vesilahti  Tieto puutt…
    ## 10 Kuukausi              1        202201  2022 921       Vesanto    Tieto puutt…
    ## # ℹ 2,070,501 more rows
    ## # ℹ 6 more variables: sukupuoli <chr>, tyomarkkinatukipaiva_luokka <chr>,
    ## #   saaja_lkm <dbl>, korvattu_paiva_lkm <dbl>, maksettu_eur <dbl>,
    ## #   kunta_osuus_eur <dbl>

Subset only municipality Veteli

``` r
veteli23 <- get_data(data_id = dsets$id[1], sql = "WHERE kunta_nro = 924 AND vuosi = 2023")
veteli23
```

    ## # A tibble: 198 × 13
    ##    aikatyyppi   kuukausi_nro vuosikuukausi vuosi kunta_nro kunta_nimi ikaryhma  
    ##    <chr>               <dbl>         <dbl> <dbl> <chr>     <chr>      <chr>     
    ##  1 Vuosikertymä            8        202308  2023 924       Veteli     Tieto puu…
    ##  2 Vuosikertymä            8        202308  2023 924       Veteli     Tieto puu…
    ##  3 Vuosikertymä            9        202309  2023 924       Veteli     Tieto puu…
    ##  4 Vuosikertymä            9        202309  2023 924       Veteli     Tieto puu…
    ##  5 Vuosikertymä           10        202310  2023 924       Veteli     Tieto puu…
    ##  6 Vuosikertymä           10        202310  2023 924       Veteli     Tieto puu…
    ##  7 Kuukausi                2        202302  2023 924       Veteli     Tieto puu…
    ##  8 Kuukausi                5        202305  2023 924       Veteli     Tieto puu…
    ##  9 Kuukausi                5        202305  2023 924       Veteli     Tieto puu…
    ## 10 Kuukausi                9        202309  2023 924       Veteli     Tieto puu…
    ## # ℹ 188 more rows
    ## # ℹ 6 more variables: sukupuoli <chr>, tyomarkkinatukipaiva_luokka <chr>,
    ## #   saaja_lkm <dbl>, korvattu_paiva_lkm <dbl>, maksettu_eur <dbl>,
    ## #   kunta_osuus_eur <dbl>
